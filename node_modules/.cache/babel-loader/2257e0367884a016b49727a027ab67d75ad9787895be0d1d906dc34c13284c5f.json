{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import style from'./recipe.module.css';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const Recipe=_ref=>{let{title,calories,image,ingredients,saved:propsSaved,onSave,onRemove}=_ref;const[showModal,setShowModal]=useState(false);const[saved,setSaved]=useState(false);const[imgLoaded,setImgLoaded]=useState(false);useEffect(()=>{// Use saved prop if provided (preferred), otherwise fallback to localStorage check\ntry{if(typeof propsSaved!=='undefined'){setSaved(propsSaved);return;}const favs=JSON.parse(window.localStorage.getItem('favorites')||'[]');setSaved(favs.some(f=>f.title===title));}catch(e){// ignore\n}},[title,propsSaved]);const toggleSave=useCallback(async()=>{if(saved){if(onRemove){try{await onRemove(title);}catch(err){console.error('Failed to remove recipe:',err);alert(err.message||'Failed to remove recipe');}setSaved(false);return;}// fallback to localStorage\ntry{const favs=JSON.parse(window.localStorage.getItem('favorites')||'[]');const next=favs.filter(f=>f.title!==title);window.localStorage.setItem('favorites',JSON.stringify(next));setSaved(false);}catch(e){console.error('localStorage remove failed',e);}}else{if(onSave){try{await onSave({title,image,calories,ingredients});setSaved(true);}catch(err){console.error('Failed to save recipe:',err);alert(err.message||'Failed to save recipe');}return;}try{const favs=JSON.parse(window.localStorage.getItem('favorites')||'[]');favs.push({title,image,calories,ingredients});window.localStorage.setItem('favorites',JSON.stringify(favs));setSaved(true);}catch(e){console.error('localStorage save failed',e);alert('Failed to save locally');}}},[saved,onSave,onRemove,title,image,calories,ingredients]);const copyLink=useCallback(async()=>{const text=\"\".concat(title);try{await navigator.clipboard.writeText(text);alert('Copied recipe title to clipboard');}catch(e){alert('Copy failed');}},[title]);return/*#__PURE__*/_jsxs(\"div\",{className:style.card,children:[/*#__PURE__*/_jsxs(\"div\",{className:style['cal-badge'],children:[Math.round(calories),\" cal\"]}),/*#__PURE__*/_jsx(\"img\",{src:image,alt:title,loading:\"lazy\",decoding:\"async\",className:imgLoaded?style['img-loaded']:'',onLoad:()=>setImgLoaded(true)}),/*#__PURE__*/_jsxs(\"div\",{className:style.overlay,children:[/*#__PURE__*/_jsx(\"button\",{className:style.btn,onClick:()=>setShowModal(true),\"aria-label\":\"View \".concat(title),children:\"View\"}),/*#__PURE__*/_jsx(\"button\",{className:style.btn,onClick:toggleSave,\"aria-pressed\":saved,\"aria-label\":\"\".concat(saved?'Unsave':'Save',\" \").concat(title),children:saved?'Saved':'Save'}),/*#__PURE__*/_jsx(\"button\",{className:style.btn,onClick:copyLink,\"aria-label\":\"Copy \".concat(title),children:\"Copy\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:style['card-body'],children:[/*#__PURE__*/_jsx(\"div\",{className:style['card-title'],children:title}),/*#__PURE__*/_jsxs(\"div\",{className:style['card-sub'],children:[ingredients.length,\" ingredients\"]})]}),showModal&&/*#__PURE__*/_jsx(\"div\",{className:style['modal-backdrop'],onClick:()=>setShowModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:style.modal,onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{className:style['modal-close'],onClick:()=>setShowModal(false),children:\"Close\"}),/*#__PURE__*/_jsx(\"h3\",{children:title}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Calories:\"}),\" \",Math.round(calories)]}),/*#__PURE__*/_jsx(\"ul\",{className:style['ingredients-list'],children:ingredients.map((ing,idx)=>/*#__PURE__*/_jsx(\"li\",{children:ing.text},idx))})]})})]});};// Prevent unnecessary re-renders: only update when minimal props change\nexport default/*#__PURE__*/React.memo(Recipe,(prev,next)=>{var _prev$ingredients,_next$ingredients;return prev.saved===next.saved&&prev.title===next.title&&prev.image===next.image&&prev.calories===next.calories&&(((_prev$ingredients=prev.ingredients)===null||_prev$ingredients===void 0?void 0:_prev$ingredients.length)||0)===(((_next$ingredients=next.ingredients)===null||_next$ingredients===void 0?void 0:_next$ingredients.length)||0);});","map":{"version":3,"names":["React","useState","useEffect","useCallback","style","jsxs","_jsxs","jsx","_jsx","Recipe","_ref","title","calories","image","ingredients","saved","propsSaved","onSave","onRemove","showModal","setShowModal","setSaved","imgLoaded","setImgLoaded","favs","JSON","parse","window","localStorage","getItem","some","f","e","toggleSave","err","console","error","alert","message","next","filter","setItem","stringify","push","copyLink","text","concat","navigator","clipboard","writeText","className","card","children","Math","round","src","alt","loading","decoding","onLoad","overlay","btn","onClick","length","modal","stopPropagation","map","ing","idx","memo","prev","_prev$ingredients","_next$ingredients"],"sources":["E:/Recipe-Haven---Food-Recipe-App.-main/src/Recipe.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport style from './recipe.module.css';\r\n\r\nconst Recipe = ({ title, calories, image, ingredients, saved: propsSaved, onSave, onRemove }) => {\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [saved, setSaved] = useState(false);\r\n  const [imgLoaded, setImgLoaded] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Use saved prop if provided (preferred), otherwise fallback to localStorage check\r\n    try {\r\n      if (typeof propsSaved !== 'undefined') {\r\n        setSaved(propsSaved);\r\n        return;\r\n      }\r\n      const favs = JSON.parse(window.localStorage.getItem('favorites') || '[]');\r\n      setSaved(favs.some((f) => f.title === title));\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n  }, [title, propsSaved]);\r\n\r\n  const toggleSave = useCallback(async () => {\r\n    if (saved) {\r\n      if (onRemove) {\r\n        try {\r\n          await onRemove(title);\r\n        } catch (err) {\r\n          console.error('Failed to remove recipe:', err);\r\n          alert(err.message || 'Failed to remove recipe');\r\n        }\r\n        setSaved(false);\r\n        return;\r\n      }\r\n\r\n      // fallback to localStorage\r\n      try {\r\n        const favs = JSON.parse(window.localStorage.getItem('favorites') || '[]');\r\n        const next = favs.filter((f) => f.title !== title);\r\n        window.localStorage.setItem('favorites', JSON.stringify(next));\r\n        setSaved(false);\r\n      } catch (e) {\r\n        console.error('localStorage remove failed', e);\r\n      }\r\n    } else {\r\n      if (onSave) {\r\n        try {\r\n          await onSave({ title, image, calories, ingredients });\r\n          setSaved(true);\r\n        } catch (err) {\r\n          console.error('Failed to save recipe:', err);\r\n          alert(err.message || 'Failed to save recipe');\r\n        }\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const favs = JSON.parse(window.localStorage.getItem('favorites') || '[]');\r\n        favs.push({ title, image, calories, ingredients });\r\n        window.localStorage.setItem('favorites', JSON.stringify(favs));\r\n        setSaved(true);\r\n      } catch (e) {\r\n        console.error('localStorage save failed', e);\r\n        alert('Failed to save locally');\r\n      }\r\n    }\r\n  }, [saved, onSave, onRemove, title, image, calories, ingredients]);\r\n\r\n  const copyLink = useCallback(async () => {\r\n    const text = `${title}`;\r\n    try {\r\n      await navigator.clipboard.writeText(text);\r\n      alert('Copied recipe title to clipboard');\r\n    } catch (e) {\r\n      alert('Copy failed');\r\n    }\r\n  }, [title]);\r\n\r\n  return (\r\n    <div className={style.card}>\r\n      <div className={style['cal-badge']}>{Math.round(calories)} cal</div>\r\n      <img\r\n        src={image}\r\n        alt={title}\r\n        loading=\"lazy\"\r\n        decoding=\"async\"\r\n        className={imgLoaded ? style['img-loaded'] : ''}\r\n        onLoad={() => setImgLoaded(true)}\r\n      />\r\n\r\n      <div className={style.overlay}>\r\n        <button className={style.btn} onClick={() => setShowModal(true)} aria-label={`View ${title}`}>View</button>\r\n        <button className={style.btn} onClick={toggleSave} aria-pressed={saved} aria-label={`${saved ? 'Unsave' : 'Save'} ${title}`}>{saved ? 'Saved' : 'Save'}</button>\r\n        <button className={style.btn} onClick={copyLink} aria-label={`Copy ${title}`}>Copy</button>\r\n      </div>\r\n\r\n      <div className={style['card-body']}>\r\n        <div className={style['card-title']}>{title}</div>\r\n        <div className={style['card-sub']}>{ingredients.length} ingredients</div>\r\n      </div>\r\n\r\n      {showModal && (\r\n        <div className={style['modal-backdrop']} onClick={() => setShowModal(false)}>\r\n          <div className={style.modal} onClick={(e) => e.stopPropagation()}>\r\n            <button className={style['modal-close']} onClick={() => setShowModal(false)}>Close</button>\r\n            <h3>{title}</h3>\r\n            <p><strong>Calories:</strong> {Math.round(calories)}</p>\r\n            <ul className={style['ingredients-list']}>\r\n              {ingredients.map((ing, idx) => (\r\n                <li key={idx}>{ing.text}</li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Prevent unnecessary re-renders: only update when minimal props change\r\nexport default React.memo(Recipe, (prev, next) => {\r\n  return (\r\n    prev.saved === next.saved &&\r\n    prev.title === next.title &&\r\n    prev.image === next.image &&\r\n    prev.calories === next.calories &&\r\n    (prev.ingredients?.length || 0) === (next.ingredients?.length || 0)\r\n  );\r\n});\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}